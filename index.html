<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Office Gallery</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Cormorant+Garamond:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #fafaf9;
            --bg-secondary: #ffffff;
            --text-primary: #1a1a1a;
            --text-secondary: #666666;
            --accent: #2c2c2c;
            --border: #e5e5e5;
            --shadow: rgba(0, 0, 0, 0.08);
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 60px 40px;
        }

        header {
            text-align: center;
            margin-bottom: 80px;
            animation: fadeInDown 0.8s ease-out;
        }

        h1 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 3.5rem;
            font-weight: 300;
            letter-spacing: 0.02em;
            margin-bottom: 16px;
            color: var(--text-primary);
        }

        .subtitle {
            font-size: 0.95rem;
            font-weight: 300;
            color: var(--text-secondary);
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }

        .tabs {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 60px;
            flex-wrap: wrap;
            animation: fadeInUp 0.8s ease-out 0.2s both;
        }

        .tab {
            padding: 14px 28px;
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 400;
            letter-spacing: 0.02em;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: var(--accent);
            transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: -1;
        }

        .tab:hover {
            border-color: var(--accent);
            color: var(--text-primary);
        }

        .tab.active {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }

        .tab.active::before {
            left: 0;
        }

        .gallery-container {
            position: relative;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: var(--bg-secondary);
            border-radius: 2px;
            overflow: hidden;
            box-shadow: 0 20px 60px var(--shadow);
            animation: fadeInUp 0.8s ease-out 0.4s both;
        }

        .gallery-content {
            display: none;
        }

        .gallery-content.active {
            display: block;
        }

        .slideshow {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            aspect-ratio: 9 / 16;
            background: #f5f5f5;
            cursor: pointer;
        }

        .slideshow.fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            max-width: none;
            aspect-ratio: auto;
            z-index: 9999;
            background: #000000;
            margin: 0;
        }

        .slideshow.fullscreen .slide {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slideshow.fullscreen .slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .slideshow.fullscreen .upload-area {
            display: none !important;
        }

        /* ì „ì²´í™”ë©´ì¼ ë•Œ ë²„íŠ¼ë“¤ê³¼ ìŠ¬ë¼ì´ë“œ ì •ë³´ ìˆ¨ê¹€ */
        .slideshow.fullscreen ~ .slideshow-start-btn,
        .slideshow.fullscreen ~ .edit-mode-btn,
        .slideshow.fullscreen ~ .slide-info {
            display: none !important;
        }

        .close-fullscreen {
            position: absolute;
            top: 30px;
            right: 30px;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-size: 24px;
            cursor: pointer;
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .close-fullscreen:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .slideshow.fullscreen .close-fullscreen {
            display: flex;
        }

        .upload-area {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.95);
            border: 2px dashed var(--border);
            z-index: 10;
        }

        .upload-area.dragover {
            background: rgba(240, 240, 240, 0.98);
            border-color: var(--accent);
        }

        .upload-icon {
            font-size: 3rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .upload-text {
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .upload-subtext {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: 300;
        }

        .edit-mode-btn {
            position: absolute;
            bottom: 20px;
            right: 20px;
            padding: 10px 20px;
            background: var(--accent);
            color: white;
            border: none;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 400;
            letter-spacing: 0.02em;
            transition: all 0.3s ease;
            z-index: 5;
        }

        .edit-mode-btn:hover {
            background: #1a1a1a;
        }

        .slideshow-start-btn {
            position: absolute;
            bottom: 20px;
            left: 20px;
            padding: 10px 20px;
            background: white;
            color: var(--accent);
            border: 1px solid var(--accent);
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 400;
            letter-spacing: 0.02em;
            transition: all 0.3s ease;
            z-index: 5;
        }

        .slideshow-start-btn:hover {
            background: var(--accent);
            color: white;
        }

        .slideshow.edit-mode .upload-area {
            display: flex;
        }

        .slideshow.edit-mode {
            cursor: default;
        }

        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 0.8s ease-in-out;
        }

        .slide.active {
            opacity: 1;
            z-index: 1;
        }

        .slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .slide-info {
            padding: 40px;
            background: var(--bg-secondary);
            text-align: center;
        }

        .slide-counter {
            font-size: 0.85rem;
            color: var(--text-secondary);
            letter-spacing: 0.1em;
            margin-bottom: 12px;
            font-weight: 300;
        }

        .location-name {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.8rem;
            font-weight: 400;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
            color: var(--text-secondary);
            font-size: 1.1rem;
            font-weight: 300;
            letter-spacing: 0.05em;
        }

        .instructions {
            margin-top: 60px;
            padding: 40px;
            background: var(--bg-secondary);
            border-left: 2px solid var(--accent);
            animation: fadeIn 1s ease-out 0.6s both;
        }

        .instructions h3 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.5rem;
            font-weight: 400;
            margin-bottom: 20px;
            color: var(--text-primary);
        }

        .instructions p {
            color: var(--text-secondary);
            line-height: 1.8;
            margin-bottom: 12px;
            font-weight: 300;
        }

        .instructions code {
            background: var(--bg-primary);
            padding: 2px 8px;
            border-radius: 2px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: var(--accent);
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 40px 20px;
            }

            h1 {
                font-size: 2.5rem;
            }

            .tabs {
                gap: 6px;
            }

            .tab {
                padding: 10px 18px;
                font-size: 0.85rem;
            }

            .slideshow {
                max-width: 100%;
            }

            .slide-info {
                padding: 30px 20px;
            }

            .location-name {
                font-size: 1.4rem;
            }

            .instructions {
                padding: 30px 20px;
            }

            .edit-mode-btn {
                bottom: 10px;
                right: 10px;
                padding: 8px 16px;
                font-size: 0.85rem;
            }

            .slideshow-start-btn {
                bottom: 10px;
                left: 10px;
                padding: 8px 16px;
                font-size: 0.85rem;
            }

            .close-fullscreen {
                top: 20px;
                right: 20px;
                width: 35px;
                height: 35px;
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Coffee Silo</h1>
            <p class="subtitle">Explore Our Locations</p>
        </header>

        <div class="tabs">
            <button class="tab active" data-tab="tab1">ì•„í¬ 12F</button>
            <button class="tab" data-tab="tab2">ì•„í¬ 4F</button>
            <button class="tab" data-tab="tab3">ì§€ì¬ì„¼ 12F</button>
            <button class="tab" data-tab="tab4">ì§€ì¬ì„¼ 14F</button>
            <button class="tab" data-tab="tab5">í”¼ë‚˜í´ 2F</button>
            <button class="tab" data-tab="tab6">í•œíƒ€ 7F</button>
            <button class="tab" data-tab="tab7">ì‹ ë…¼í˜„ í† ìŠ¤ ì˜¤í”¼ìŠ¤</button>
        </div>

        <div class="gallery-container">
            <div class="gallery-content active" id="tab1">
                <div class="slideshow" id="slideshow-tab1" data-tab="tab1">
                    <div class="slide active">
                        <div class="placeholder">ì´ë¯¸ì§€ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”</div>
                    </div>
                    <div class="upload-area">
                        <div class="upload-icon">ğŸ“·</div>
                        <div class="upload-text">ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</div>
                        <div class="upload-subtext">ì—¬ëŸ¬ ì¥ì˜ ì´ë¯¸ì§€ë¥¼ í•œ ë²ˆì— ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</div>
                        <input type="file" accept="image/*" multiple style="display: none;" class="file-input">
                    </div>
                    <button class="close-fullscreen">Ã—</button>
                </div>
                <button class="slideshow-start-btn" data-target="slideshow-tab1">â–¶ ìŠ¬ë¼ì´ë“œì‡¼ ì‹œì‘</button>
                <button class="edit-mode-btn" data-target="slideshow-tab1">ì´ë¯¸ì§€ ì¶”ê°€</button>
                <div class="slide-info">
                    <div class="slide-counter"><span class="current">1</span> / <span class="total">1</span></div>
                    <h2 class="location-name">ì•„í¬ 12F</h2>
                </div>
            </div>

            <div class="gallery-content" id="tab2">
                <div class="slideshow" id="slideshow-tab2" data-tab="tab2">
                    <div class="slide active">
                        <div class="placeholder">ì´ë¯¸ì§€ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”</div>
                    </div>
                    <div class="upload-area">
                        <div class="upload-icon">ğŸ“·</div>
                        <div class="upload-text">ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</div>
                        <div class="upload-subtext">ì—¬ëŸ¬ ì¥ì˜ ì´ë¯¸ì§€ë¥¼ í•œ ë²ˆì— ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</div>
                        <input type="file" accept="image/*" multiple style="display: none;" class="file-input">
                    </div>
                    <button class="close-fullscreen">Ã—</button>
                </div>
                <button class="slideshow-start-btn" data-target="slideshow-tab2">â–¶ ìŠ¬ë¼ì´ë“œì‡¼ ì‹œì‘</button>
                <button class="edit-mode-btn" data-target="slideshow-tab2">ì´ë¯¸ì§€ ì¶”ê°€</button>
                <div class="slide-info">
                    <div class="slide-counter"><span class="current">1</span> / <span class="total">1</span></div>
                    <h2 class="location-name">ì•„í¬ 4F</h2>
                </div>
            </div>

            <div class="gallery-content" id="tab3">
                <div class="slideshow" id="slideshow-tab3" data-tab="tab3">
                    <div class="slide active">
                        <div class="placeholder">ì´ë¯¸ì§€ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”</div>
                    </div>
                    <div class="upload-area">
                        <div class="upload-icon">ğŸ“·</div>
                        <div class="upload-text">ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</div>
                        <div class="upload-subtext">ì—¬ëŸ¬ ì¥ì˜ ì´ë¯¸ì§€ë¥¼ í•œ ë²ˆì— ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</div>
                        <input type="file" accept="image/*" multiple style="display: none;" class="file-input">
                    </div>
                    <button class="close-fullscreen">Ã—</button>
                </div>
                <button class="slideshow-start-btn" data-target="slideshow-tab3">â–¶ ìŠ¬ë¼ì´ë“œì‡¼ ì‹œì‘</button>
                <button class="edit-mode-btn" data-target="slideshow-tab3">ì´ë¯¸ì§€ ì¶”ê°€</button>
                <div class="slide-info">
                    <div class="slide-counter"><span class="current">1</span> / <span class="total">1</span></div>
                    <h2 class="location-name">ì§€ì¬ì„¼ 12F</h2>
                </div>
            </div>

            <div class="gallery-content" id="tab4">
                <div class="slideshow" id="slideshow-tab4" data-tab="tab4">
                    <div class="slide active">
                        <div class="placeholder">ì´ë¯¸ì§€ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”</div>
                    </div>
                    <div class="upload-area">
                        <div class="upload-icon">ğŸ“·</div>
                        <div class="upload-text">ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</div>
                        <div class="upload-subtext">ì—¬ëŸ¬ ì¥ì˜ ì´ë¯¸ì§€ë¥¼ í•œ ë²ˆì— ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</div>
                        <input type="file" accept="image/*" multiple style="display: none;" class="file-input">
                    </div>
                    <button class="close-fullscreen">Ã—</button>
                </div>
                <button class="slideshow-start-btn" data-target="slideshow-tab4">â–¶ ìŠ¬ë¼ì´ë“œì‡¼ ì‹œì‘</button>
                <button class="edit-mode-btn" data-target="slideshow-tab4">ì´ë¯¸ì§€ ì¶”ê°€</button>
                <div class="slide-info">
                    <div class="slide-counter"><span class="current">1</span> / <span class="total">1</span></div>
                    <h2 class="location-name">ì§€ì¬ì„¼ 14F</h2>
                </div>
            </div>

            <div class="gallery-content" id="tab5">
                <div class="slideshow" id="slideshow-tab5" data-tab="tab5">
                    <div class="slide active">
                        <div class="placeholder">ì´ë¯¸ì§€ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”</div>
                    </div>
                    <div class="upload-area">
                        <div class="upload-icon">ğŸ“·</div>
                        <div class="upload-text">ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</div>
                        <div class="upload-subtext">ì—¬ëŸ¬ ì¥ì˜ ì´ë¯¸ì§€ë¥¼ í•œ ë²ˆì— ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</div>
                        <input type="file" accept="image/*" multiple style="display: none;" class="file-input">
                    </div>
                    <button class="close-fullscreen">Ã—</button>
                </div>
                <button class="slideshow-start-btn" data-target="slideshow-tab5">â–¶ ìŠ¬ë¼ì´ë“œì‡¼ ì‹œì‘</button>
                <button class="edit-mode-btn" data-target="slideshow-tab5">ì´ë¯¸ì§€ ì¶”ê°€</button>
                <div class="slide-info">
                    <div class="slide-counter"><span class="current">1</span> / <span class="total">1</span></div>
                    <h2 class="location-name">í”¼ë‚˜í´ 2F</h2>
                </div>
            </div>

            <div class="gallery-content" id="tab6">
                <div class="slideshow" id="slideshow-tab6" data-tab="tab6">
                    <div class="slide active">
                        <div class="placeholder">ì´ë¯¸ì§€ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”</div>
                    </div>
                    <div class="upload-area">
                        <div class="upload-icon">ğŸ“·</div>
                        <div class="upload-text">ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</div>
                        <div class="upload-subtext">ì—¬ëŸ¬ ì¥ì˜ ì´ë¯¸ì§€ë¥¼ í•œ ë²ˆì— ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</div>
                        <input type="file" accept="image/*" multiple style="display: none;" class="file-input">
                    </div>
                    <button class="close-fullscreen">Ã—</button>
                </div>
                <button class="slideshow-start-btn" data-target="slideshow-tab6">â–¶ ìŠ¬ë¼ì´ë“œì‡¼ ì‹œì‘</button>
                <button class="edit-mode-btn" data-target="slideshow-tab6">ì´ë¯¸ì§€ ì¶”ê°€</button>
                <div class="slide-info">
                    <div class="slide-counter"><span class="current">1</span> / <span class="total">1</span></div>
                    <h2 class="location-name">í•œíƒ€ 7F</h2>
                </div>
            </div>

            <div class="gallery-content" id="tab7">
                <div class="slideshow" id="slideshow-tab7" data-tab="tab7">
                    <div class="slide active">
                        <div class="placeholder">ì´ë¯¸ì§€ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”</div>
                    </div>
                    <div class="upload-area">
                        <div class="upload-icon">ğŸ“·</div>
                        <div class="upload-text">ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</div>
                        <div class="upload-subtext">ì—¬ëŸ¬ ì¥ì˜ ì´ë¯¸ì§€ë¥¼ í•œ ë²ˆì— ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</div>
                        <input type="file" accept="image/*" multiple style="display: none;" class="file-input">
                    </div>
                    <button class="close-fullscreen">Ã—</button>
                </div>
                <button class="slideshow-start-btn" data-target="slideshow-tab7">â–¶ ìŠ¬ë¼ì´ë“œì‡¼ ì‹œì‘</button>
                <button class="edit-mode-btn" data-target="slideshow-tab7">ì´ë¯¸ì§€ ì¶”ê°€</button>
                <div class="slide-info">
                    <div class="slide-counter"><span class="current">1</span> / <span class="total">1</span></div>
                    <h2 class="location-name">ì‹ ë…¼í˜„ í† ìŠ¤ ì˜¤í”¼ìŠ¤</h2>
                </div>
            </div>
        </div>

        <div class="instructions">
            <h3>ì‚¬ìš© ë°©ë²•</h3>
            <p><strong>ì´ë¯¸ì§€ ì¶”ê°€:</strong> ê° íƒ­ì—ì„œ "ì´ë¯¸ì§€ ì¶”ê°€" ë²„íŠ¼ì„ í´ë¦­í•œ í›„, ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ì—¬ ì—…ë¡œë“œí•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì„ íƒí•˜ì„¸ìš”. ì—¬ëŸ¬ ì¥ì„ í•œ ë²ˆì— ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            <p><strong>ì „ì²´í™”ë©´ ë³´ê¸°:</strong> ì´ë¯¸ì§€ë¥¼ í´ë¦­í•˜ë©´ ì „ì²´í™”ë©´ìœ¼ë¡œ í™•ëŒ€ë©ë‹ˆë‹¤. ESC í‚¤ë‚˜ Ã— ë²„íŠ¼ìœ¼ë¡œ ë‹«ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            <p><strong>ìë™ ìŠ¬ë¼ì´ë“œ:</strong> ì´ë¯¸ì§€ê°€ 2ì¥ ì´ìƒì¼ ê²½ìš° 5ì´ˆë§ˆë‹¤ ìë™ìœ¼ë¡œ ì „í™˜ë©ë‹ˆë‹¤.</p>
            <p style="margin-top: 20px; color: var(--text-secondary); font-size: 0.9rem;">
                ğŸ’¡ íŒ: ì„¸ë¡œ ì´ë¯¸ì§€(9:16 ë¹„ìœ¨)ì— ìµœì í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
            </p>
        </div>
    </div>

    <script>
/*
  ê°œì„  ë‚´ìš© ìš”ì•½:
  - ê° ìŠ¬ë¼ì´ë“œì‡¼ ì¸ìŠ¤í„´ìŠ¤ë³„ë¡œ ìƒíƒœ(start/interval/currentIdx)ë¥¼ ëª…í™•íˆ ê´€ë¦¬
  - "ì§„ì§œ" ì „ì²´í™”ë©´ API(requestFullscreen / exitFullscreen) ì‚¬ìš© (ì‚¬ìš©ì ì œìŠ¤ì²˜ ë‚´ì—ì„œ í˜¸ì¶œ)
  - fullscreenchange ì´ë²¤íŠ¸ë¡œ í´ë˜ìŠ¤/ìŠ¤í¬ë¡¤ ë™ê¸°í™”
  - í´ë¦­/ì—…ë¡œë“œ/ì—ë””íŠ¸ ëª¨ë“œ ì¶©ëŒ ë°©ì§€
*/
document.addEventListener('DOMContentLoaded', () => {
  initTabs();
  initImageUpload();
  initSlideshowStartButtons();
  initFullscreenHandlers();
  // ì´ˆê¸° íƒ­ í™œì„±í™”(HTMLì—ì„œ ì²« íƒ­ì´ activeë¼ë©´ ê·¸ IDë¡œ ì‹œì‘)
  const activeTab = document.querySelector('.tab.active')?.dataset.tab || 'tab1';
  startSlideshowForTab(activeTab);
});

const slideshowState = {}; // { tabId: { intervalId, currentIndex } }

// íƒ­ ì „í™˜
function initTabs(){
  const tabs = document.querySelectorAll('.tab');
  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      const tabId = tab.dataset.tab;
      // deactivate all
      tabs.forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.gallery-content').forEach(c => c.classList.remove('active'));
      // activate clicked
      tab.classList.add('active');
      document.getElementById(tabId).classList.add('active');
      // stop all intervals
      Object.values(slideshowState).forEach(s => {
        if (s.intervalId) clearInterval(s.intervalId);
      });
      startSlideshowForTab(tabId);
    });
  });
}

// ìŠ¬ë¼ì´ë“œì‡¼ ì‹œì‘ (tabId: 'tab1' ë“±)
function startSlideshowForTab(tabId) {
  const slideshow = document.getElementById(`slideshow-${tabId}`);
  if (!slideshow) return;
  const slides = Array.from(slideshow.querySelectorAll('.slide'));
  const counter = slideshow.parentElement.querySelector('.slide-counter');
  const totalElem = counter?.querySelector('.total');
  const currentElem = counter?.querySelector('.current');

  // ì´ˆê¸° total/current ì„¸íŒ…
  const total = slides.length || 0;
  if (totalElem) totalElem.textContent = total;
  if (currentElem) currentElem.textContent = total ? 1 : 1;

  // clear previous interval if any
  if (slideshowState[tabId]?.intervalId) {
    clearInterval(slideshowState[tabId].intervalId);
  }

  // í•œ ì¥ ì´í•˜ì´ë©´ ìë™ ìŠ¬ë¼ì´ë“œ ì•ˆ í•¨
  if (total <= 1) {
    slideshowState[tabId] = { intervalId: null, currentIndex: 0 };
    return;
  }

  let currentIndex = 0;
  // ensure only one active
  slides.forEach((s, i) => s.classList.toggle('active', i === 0));
  if (currentElem) currentElem.textContent = 1;

  const intervalId = setInterval(() => {
    slides[currentIndex].classList.remove('active');
    currentIndex = (currentIndex + 1) % slides.length;
    slides[currentIndex].classList.add('active');
    if (currentElem) currentElem.textContent = currentIndex + 1;
  }, 5000);

  slideshowState[tabId] = { intervalId, currentIndex };
}

// Upload / edit mode
function initImageUpload() {
  const editBtns = document.querySelectorAll('.edit-mode-btn');
  editBtns.forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const targetId = btn.dataset.target;
      const slideshow = document.getElementById(targetId);
      slideshow.classList.toggle('edit-mode');
    });
  });

  const uploadAreas = document.querySelectorAll('.upload-area');
  uploadAreas.forEach(uploadArea => {
    const fileInput = uploadArea.querySelector('.file-input');
    const slideshow = uploadArea.closest('.slideshow');

    // í´ë¦­ìœ¼ë¡œ íŒŒì¼ ì„ íƒ
    uploadArea.addEventListener('click', (e) => {
      e.stopPropagation();
      fileInput.click();
    });

    // ë“œë˜ê·¸ì•¤ë“œë¡­
    uploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadArea.classList.add('dragover');
    });
    uploadArea.addEventListener('dragleave', (e) => {
      e.preventDefault();
      uploadArea.classList.remove('dragover');
    });
    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadArea.classList.remove('dragover');
      const files = e.dataTransfer.files;
      handleFiles(files, slideshow);
    });

    // íŒŒì¼ ì„ íƒ
    fileInput.addEventListener('change', (e) => {
      const files = e.target.files;
      handleFiles(files, slideshow);
    });
  });
}

function handleFiles(files, slideshow) {
  const tabId = slideshow.dataset.tab;
  
  // ê¸°ì¡´ ìŠ¬ë¼ì´ë“œ ì œê±°
  const existingSlides = slideshow.querySelectorAll('.slide');
  existingSlides.forEach(slide => slide.remove());
  
  // ìƒˆ ì´ë¯¸ì§€ ìŠ¬ë¼ì´ë“œ ì¶”ê°€
  Array.from(files).forEach((file, index) => {
    if (file.type.startsWith('image/')) {
      const reader = new FileReader();
      
      reader.onload = (e) => {
        const slide = document.createElement('div');
        slide.className = index === 0 ? 'slide active' : 'slide';
        
        const img = document.createElement('img');
        img.src = e.target.result;
        img.alt = file.name;
        
        slide.appendChild(img);
        slideshow.insertBefore(slide, slideshow.querySelector('.upload-area'));
        
        // ë§ˆì§€ë§‰ ì´ë¯¸ì§€ê°€ ë¡œë“œë˜ë©´
        if (index === files.length - 1) {
          slideshow.classList.remove('edit-mode');
          
          // ìŠ¬ë¼ì´ë“œì‡¼ ì¬ì‹œì‘
          if (slideshowState[tabId]?.intervalId) {
            clearInterval(slideshowState[tabId].intervalId);
          }
          startSlideshowForTab(tabId);
        }
      };
      
      reader.readAsDataURL(file);
    }
  });
}

// ===== ì•ˆì „í•œ ì „ì²´í™”ë©´ ë˜í¼ =====
function requestFullscreenOnElement(el) {
  if (!el) return Promise.reject(new Error('no element'));

  const req = el.requestFullscreen || el.webkitRequestFullscreen || el.mozRequestFullScreen || el.msRequestFullscreen;
  if (!req) {
    // API ìì²´ ë¯¸ì§€ì› -> CSS í´ë°±
    applyCssFullscreenFallback(el);
    showPermissionToast('ë¸Œë¼ìš°ì €ê°€ ì „ì²´í™”ë©´ APIë¥¼ ì§€ì›í•˜ì§€ ì•Šì•„ CSS í´ë°±ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.');
    return Promise.resolve('css-fallback');
  }

  // ì‹¤ì œ ìš”ì²­ (ë°˜ë“œì‹œ ì‚¬ìš©ì ì œìŠ¤ì²˜ ë‚´ì—ì„œ í˜¸ì¶œí•´ì•¼ ë¸Œë¼ìš°ì €ì—ì„œ í—ˆìš©)
  return req.call(el)
    .then(() => {
      // ì„±ê³µ
      return 'native';
    })
    .catch(err => {
      // ì‹¤íŒ¨ ì‚¬ìœ (ê¶Œí•œì •ì±… ë“±) -> CSS í´ë°±
      console.warn('requestFullscreen ì‹¤íŒ¨:', err);
      applyCssFullscreenFallback(el);
      showPermissionToast('ì „ì²´í™”ë©´ ìš”ì²­ì´ ì°¨ë‹¨ë˜ì–´ CSS í´ë°±ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.');
      return 'css-fallback';
    });
}

function applyCssFullscreenFallback(el) {
  if (!el) return;
  el.classList.add('fullscreen');
  document.body.style.overflow = 'hidden';
}

function exitCssFullscreenFallback(el) {
  if (!el) return;
  el.classList.remove('fullscreen');
  document.body.style.overflow = '';
}

function showPermissionToast(msg) {
  const id = 'fs-perm-toast';
  if (document.getElementById(id)) return;
  const d = document.createElement('div');
  d.id = id;
  d.textContent = msg || 'ì „ì²´í™”ë©´ ê¶Œí•œì´ ì—†ì–´ CSS í´ë°±ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.';
  Object.assign(d.style, {
    position: 'fixed', left: '50%', transform: 'translateX(-50%)',
    bottom: '18px', background: '#111', color: '#fff', padding: '10px 14px',
    borderRadius: '8px', zIndex: 30000, fontSize: '13px', opacity: '0.95'
  });
  document.body.appendChild(d);
  setTimeout(() => d.remove(), 6000);
}

// ===== ìŠ¬ë¼ì´ë“œì‡¼ ì‹œì‘ ë²„íŠ¼ =====
function initSlideshowStartButtons() {
  const startBtns = document.querySelectorAll('.slideshow-start-btn');
  startBtns.forEach(btn => {
    btn.addEventListener('click', async (e) => {
      e.stopPropagation();
      const targetId = btn.dataset.target;
      const slideshow = document.getElementById(targetId);
      if (!slideshow) return;

      // ë¨¼ì € UI í‘œì‹œ(ë¹ ë¥¸ ë°˜ì‘)
      slideshow.classList.add('fullscreen');

      // ì‚¬ìš©ì ì œìŠ¤ì²˜ ë‚´ì—ì„œ requestFullscreen ì‹œë„
      const result = await requestFullscreenOnElement(slideshow);
      // result === 'native' or 'css-fallback'
    });
  });
}

// ===== ì „ì²´í™”ë©´ í•¸ë“¤ëŸ¬ =====
function initFullscreenHandlers() {
  // ë‹«ê¸° ë²„íŠ¼
  document.querySelectorAll('.close-fullscreen').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const slideshow = btn.closest('.slideshow');
      if (!slideshow) return;

      // If native fullscreen active on this element, exit native
      if (document.fullscreenElement === slideshow) {
        const exit = document.exitFullscreen || document.webkitExitFullscreen || document.mozCancelFullScreen || document.msExitFullscreen;
        if (exit) {
          exit.call(document).catch(()=>{/*ignore*/});
        }
      }
      // Always remove CSS fallback
      exitCssFullscreenFallback(slideshow);
    });
  });

  // fullscreenchange ë™ê¸°í™” (ë¸Œë¼ìš°ì € ë„¤ì´í‹°ë¸Œ ì „ì²´í™”ë©´ ë³€ë™ ì‹œ)
  document.addEventListener('fullscreenchange', () => {
    const fsEl = document.fullscreenElement;
    // ëª¨ë“  slideshowì— ëŒ€í•´, nativeê°€ ì•„ë‹ˆë©´ css í´ë˜ìŠ¤ ì œê±°
    document.querySelectorAll('.slideshow').forEach(s => {
      if (!fsEl || s !== fsEl) {
        s.classList.remove('fullscreen');
      } else {
        // native í™œì„± ìŠ¬ë¼ì´ë“œì‡¼ --> ë³´ì¥
        s.classList.add('fullscreen');
        document.body.style.overflow = 'hidden';
      }
    });
    if (!document.fullscreenElement) {
      document.body.style.overflow = '';
    }
  });

  // ESC í‚¤ ë³´ì¡° (ë¸Œë¼ìš°ì €ê°€ ê¸°ë³¸ ë™ì‘ì„ ì²˜ë¦¬í•˜ì§€ë§Œ CSS í´ë°± ì¼€ì–´)
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      const cssFs = document.querySelector('.slideshow.fullscreen');
      if (cssFs && !document.fullscreenElement) {
        exitCssFullscreenFallback(cssFs);
      }
    }
  });
}
    </script>
</body>
</html>